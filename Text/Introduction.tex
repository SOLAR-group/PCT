\section{Introduction}

\IEEEPARstart{T}{he} video games industry grows exponentially every year~\cite{rykala2020growth}. With every passing day, the demand for video games content keeps growing, with players requesting - and more often than not, expecting - more content than developers can produce. Content generation is a generally slow, tedious, costly, and error-prone manual process. 
%The systematic reuse of previously generated content, or parts of it, in order to minimize bugs and cut development times is a very common occurrence within the video games industry~\cite{neto2009reuse}. However, manual reuse of content is typically frowned upon by the players: since developers tend to look at the components that they are most knowledgeable about for reuse, new content that is created from existing content tends to feel repetitive, unoriginal, and low-effort. This is especially true for video game content that has associated visual components (e.g. moving parts with reused animations).
In order to cope with the growing demand for novel, original content for video games, researchers alike are working towards procedural content generation. Procedural content generation (PCG) refers to the field of knowledge that aims at the automatic generation of new content within video games~\cite{hendrikx2013procedural}. 
To this extent, PCG has explored different techniques that Barriga \etal~\cite{Barriga2019} grouped in three categories: Traditional methods that generate content under a procedure without evaluation; Machine Learning methods that train models to generate new content; and Search-Based methods that generate content through a search on a predefined space guided by a meta-heuristic using one or more objective functions.


In this paper, we propose a new angle to tackle PCG inspired by transplantation techniques~\cite{barr2015automated}, that we named as Procedural Content Transplantation (PCT). By definition, \textit{transplantation} is a procedure in which cells, tissues, or organs of an individual are replaced by those of another individual or the same person~\cite{FARSHBAFNADI2023599}. The transplantation core idea has been adapted to other research areas such us the Software research community. In Software we understand transplantation as a procedure in which a fragment of code (organ) of a program (donor) is transferred into another program (host). Within the Software research community, transplantation has been used in research areas such as, program repair, testing, security, or functionality improvements. We propose its novel use on the area of PCG.

Current approaches of PCG work as follow, developers provide initial content (usually human-generated content) into an algorithm to work with. Then the algorithm (Traditional, Machine Learning, or Search-Based methods) will generate new content. Only few traditional methods have succeeded in providing a tool used by the industry to generate (mainly random) vegetation (e.g., SpeedTree in Unreal and Unity).
Our PCT proposal introduce the transplantation metaphor into this process. Developers from the human-generated content will select an organ (from a donor) and host that will receive the organ. The host and the organ will pass into the transplantation algorithm that will generate new content combining them. Our hypothesis is that transplantation provides more control to developers (identifying host and organ) leading to results that are closer to developersâ€™ expectations.

Our work propose a PCT algorithm that works with Search-Based Software Engineering.
Search-Based Software Engineering has a better shot at exploring large search spaces than humans. In the state-of-the-art of software transplantation, the search evolves by genetic operations (crossover and mutation) and guided by a test objective function. On other hand, in the field of Search-Based Procedural Content Generation (SBPCG) in a common practice to guide the search is guided a simulation objective function.
Taking into account the differences in software transplantation and SBPCG, we propose leveraging simulations to guide the transplantation algorithm, and we compare two different objective functions (tests and game simulations).

Another difference between the state-of-the-art of software transplantation and SBPCG is the representation of the problem. Software transplantation works directly over the source code of a program, and due to the nature of video games, in SBPCG is common the use of software models to treat the content. 
In this paper, we work with a representation closer to SBPCG using in our representation software models.

Our approach, called Imhotep\footnote{Our approach is named after Imhotep, who is considered by many to have written the Edwin Smith papyrus (the oldest known manual of surgery).}, transplant software models through a search-based approach which uses crossover and mutation as genetic operations, and is guided by two objective functions (Test Suite and Simulation). Imhotep Test-based and Simulation-based variants are compared between them and a PCG Baseline~\cite{gallotta2022evolving}. We have done our evaluation using the \CaseStudy{} case study. \CaseStudy{} is a video game about flying and shooting with a spaceship in a three-dimensional space\footnote{See the official PlayStation trailer to learn more about: \CaseStudy{} \url{https://youtu.be/EhsejJBp8Go}}. It was released on PC, PlayStation, and translated to eight different languages.

To evaluate Imhotep, 129 different organs extracted from the scenario of \CaseStudy are transplanted into 5 of the video game bosses that act as hosts, generating new video game bosses in the process. In total, our approach works with 645 transplants. We evaluate the generated content through simulation that measures the quality of the generated content by means of the duration of a match between the generated boss and a simulated player, a metric from the literature~\cite{browne2010evolutionary}. 

The results show that, out of the 3 objective functions, the content generated through game simulations obtains the best results for all the generation scenarios (that is, for the 5 bosses that act as hosts). The tests-based fitness obtains the second place, with the baseline fitness obtaining worse results than the other two in all scenarios. The generated results are promising, since they can be used as a starting point for the work of the developers. From the generated content, the developers can either include the generated content in the game, modify the generated content to better suit their needs, or inspect the generated content to find novelties from which they can create more original designs. 

Our contributions are as follows:
\begin{itemize}
    \item Novel application of Software Transplantation on Procedural Content Generation or PCT
    \item Software Transplantation of models instead of code
    \item Comparative of two objective functions, one based on Software Transplantation and the other PCG 
\end{itemize}

The rest of the paper is structured as follows: Section~\ref{sec:Related} reviews the works related to this one. Section~\ref{sec:Background} provides the research framework for our work. Section~\ref{sec:Approach} describes our approach, depicting its usage for PCG. Section~\ref{sec:Evaluation} details the evaluation of our approach and the obtained results. Section~\ref{sec:Discussion} discusses the outcomes of the paper and highlights future lines of work. Section~\ref{sec:Threats} presents the threats to the validity of our work. Finally, Section~\ref{sec:Conclusion} concludes the paper by summarizing the main contributions and results.